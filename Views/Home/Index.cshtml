@model IEnumerable<NewsApplication.Models.Post>

@{
  ViewBag.Title = "Index";
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<h2>Index</h2>

<p>
  @Html.ActionLink("Create New", "Create")
</p>
<table class="table">
  <tr>
    <th>
      @Html.DisplayNameFor(model => model.Author.Email)
    </th>
    <th>
      @Html.DisplayNameFor(model => model.Title)
    </th>
    <th>
      @Html.DisplayNameFor(model => model.Content)
    </th>
    <th>
      @Html.DisplayNameFor(model => model.ImageUrl)
    </th>
    <th>
      @Html.DisplayNameFor(model => model.Views)
    </th>
    <th>
      @Html.DisplayNameFor(model => model.CreatedAt)
    </th>
    <th>
      @Html.DisplayNameFor(model => model.UpdatedAt)
    </th>
    <th></th>
  </tr>

  @foreach (var item in Model)
  {
    <tr>
      <td>
        @Html.DisplayFor(modelItem => item.Author.Email)
      </td>
      <td>
        @Html.DisplayFor(modelItem => item.Title)
      </td>
      <td>
        @Html.DisplayFor(modelItem => item.Content)
      </td>
      <td>
        @Html.DisplayFor(modelItem => item.ImageUrl)
      </td>
      <td>
        @Html.DisplayFor(modelItem => item.Views)
      </td>
      <td>
        @Html.DisplayFor(modelItem => item.CreatedAt)
      </td>
      <td>
        @Html.DisplayFor(modelItem => item.UpdatedAt)
      </td>
      <td>
        @Html.ActionLink("Save", "bookmark", "post", new { id = item.PostId }, null)
        <button id="save" data-post-id="@item.PostId">save</button>
      </td>
    </tr>
  }
</table>

<button type="button" class="btn btn-primary" id="liveToastBtn">Show live toast</button>

<div class="position-fixed bottom-0 right-0 p-3" style="z-index: 5; right: 0; bottom: 0;">
  <div id="liveToast" class="toast show" role="alert" aria-live="assertive" aria-atomic="true" data-delay="2000">
    <div class="toast-header">
      <img src="..." class="rounded mr-2" alt="...">
      <strong class="mr-auto">Bootstrap</strong>
      <small>11 mins ago</small>
      <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="toast-body">
      Hello, world! This is a toast message.
    </div>
  </div>
</div>

@section scripts
  {
  <script>
    $(document).ready(() => {
      $("#save").click(e => {
        var button = $(e.target);
        var id = button.attr("data-post-id");
        $.ajax({
          url: "/post/bookmark",
          dataType: "json",
          type: "POST",
          contentType: 'application/json; charset=utf-8',
          data: JSON.stringify({ Id: id}),
          success: function (data) {
            console.log(data);
          },
          error: function (xhr) {
            console.log('error');
          }
        });
      })
    })

  </script>
}